<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="http://schemas.panthernet.ru/graphx/"
                    xmlns:icons="Controls"
                    xmlns:po="http://schemas.microsoft.com/winfx/2006/xaml/presentation/options">

    <LinearGradientBrush x:Key="NormalBrush" EndPoint="0.5,1" StartPoint="0.5,0" po:Freeze="true">
        <GradientStop Color="#FFFFFFFF" Offset="0"/>
        <GradientStop Color="#FFA4ADBB" Offset="0.521"/>
        <GradientStop Color="#FFD7E0EA" Offset="0.194"/>
        <GradientStop Color="#FFBAC1CF" Offset="0.811"/>
        <GradientStop Color="#FFBCC5D5" Offset="0.507"/>
        <GradientStop Color="#FFE3E4E6" Offset="1"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="NormalBorderBrush" EndPoint="0.5,0" StartPoint="0.5,1" po:Freeze="true">
        <GradientStop Color="#FF8B8B8B"/>
        <GradientStop Color="#FFADADAD" Offset="1"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="EdgeBrush" EndPoint="0.5,0" StartPoint="0.5,1" po:Freeze="true">
        <GradientStop Color="#FF000000"/>
        <GradientStop Color="#FF95EAE2" Offset="1"/>
    </LinearGradientBrush>

    <SolidColorBrush x:Key="EdgeArrowBrush" Color="Black" po:Freeze="true" />

    <!-- VERTEX CONTROL -->
    <Style TargetType="{x:Type controls:VertexControl}">
        <Setter Property="Background" Value="White"/>
        <Setter Property="Padding" Value="10,5,10,5"/>
        <Setter Property="BorderBrush" Value="Black"/>
        <Setter Property="BorderThickness" Value="3"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:VertexControl}">
                    <Grid>
                        <Border x:Name="BackgroundNorm" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="5" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}"/>
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="3" MinWidth="120">
                                <Label Content="Name:"/>
                                <TextBox Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" TextAlignment="Left"
                                         HorizontalAlignment="Center" FontWeight="Bold" Foreground="Black" Background="Transparent" Width="50"/>
                                <Button MaxHeight="20" Command="{Binding ChangeHidingCommand}" Background="Transparent" BorderThickness="0">
                                    <Path Data="F1 M330,330z M0,0z M325.607,304.394L262.128,240.915C300.698,211.88 325.65,175.995 327.375,173.478 330.876,168.368 330.876,161.632 327.375,156.522 324.45,152.253 254.716,51.978 165.004,51.978 139.132,51.978 114.929,60.323 93.5050000000001,72.291L25.607,4.394C19.75,-1.464 10.252,-1.464 4.394,4.394 -1.464,10.252 -1.464,19.749 4.394,25.607L67.872,89.085C29.299,118.12 4.35,154.006 2.625,156.523 -0.875,161.632 -0.875,168.368 2.625,173.478 5.55,177.746 75.275,278.024 165.003,278.024 190.871,278.024 215.072,269.679 236.496,257.71L304.393,325.608C307.323,328.536 311.161,330 315,330 318.839,330 322.678,328.536 325.606,325.606 331.465,319.749 331.465,310.252 325.607,304.394z M165.003,81.977C225.263,81.977 278.411,142.315 296.26,164.999 286.587,177.293 266.555,200.628 240.651,219.438L115.673,94.461C131.079,86.902,147.736,81.977,165.003,81.977z M165.003,248.023C104.718,248.023 51.564,187.659 33.73,164.986 43.381,152.683 63.382,129.328 89.304,110.516L214.294,235.506C198.884,243.084,182.236,248.023,165.003,248.023z"
                                              Fill="Black" Stretch="Uniform"/>
                                </Button>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="3" MinWidth="120">
                                <Label Content="Is final:"/>
                                <CheckBox IsChecked="{Binding IsFinal, Mode=TwoWay}" VerticalAlignment="Center"
                                         HorizontalAlignment="Center" FontWeight="Bold" Foreground="Black" Background="Transparent"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="3" MinWidth="120">
                                <Label Content="Is initital:"/>
                                <CheckBox IsChecked="{Binding IsInitial, Mode=TwoWay}" VerticalAlignment="Center"
                                         HorizontalAlignment="Center" FontWeight="Bold" Foreground="Black" Background="Transparent"/>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>

        <!-- VERTEX DRAGGING CONTROL -->
        <Setter Property="controls:DragBehaviour.IsDragEnabled" Value="False" />
        <Setter Property="controls:DragBehaviour.UpdateEdgesOnMove" Value="True" />

        <Style.Triggers>
            <Trigger Property="controls:HighlightBehaviour.Highlighted" Value="True">
                <Setter Property="BorderBrush" Value="Gold"/>
                <Setter Property="BorderThickness" Value="3"/>
            </Trigger>
            <DataTrigger Binding="{Binding IsInitial}" Value="True">
                <Setter Property="BorderBrush" Value="Green"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding IsFinal}" Value="True">
                <Setter Property="BorderBrush" Value="Red"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding IsExpanded}" Value="False">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type controls:VertexControl}">
                            <Border x:Name="BackgroundNorm" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="5" 
                                    Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Name, Mode=TwoWay}" VerticalAlignment="Center" TextAlignment="Center"
                                         HorizontalAlignment="Center" FontWeight="Bold" Foreground="Black" Background="Transparent"/>
                                    <Button MaxHeight="20" Command="{Binding ChangeHidingCommand}" Background="Transparent" BorderThickness="0">
                                        <Path Data="F1 M16,16z M0,0z M13.657,2.343A2,2,0,0,1,13.657,5.172L6.27,12.558A2.5,2.5,0,0,1,5.109,13.216L2.818,13.788A0.5,0.5,0,0,1,2.212,13.182L2.784,10.891A2.5,2.5,0,0,1,3.442,9.73L10.828,2.343A2,2,0,0,1,13.657,2.343z M10.12,4.464L4.15,10.437A1.5,1.5,0,0,0,3.756,11.134L3.385,12.616 4.867,12.246A1.5,1.5,0,0,0,5.564,11.851L11.536,5.878 10.122,4.464z M11.535,3.05L10.827,3.757 12.241,5.171 12.949,4.464A1,1,0,1,0,11.535,3.05z"
                                              Clip="M0,0 V16 H16 V0 H0 Z" Fill="Black" Stretch="Uniform"/>
                                    </Button>
                                </StackPanel>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
        </Style.Triggers>

    </Style>

    <!-- EDGE CONTROL -->
    <Style TargetType="{x:Type controls:EdgeControl}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:EdgeControl}">
                    <Grid>
                        <StackPanel Orientation="Horizontal" x:Name="PART_SelfLoopedEdge">
                            <Path  Width="20" Height="20" Stretch="Uniform" Fill="Black" Opacity="1" Clip="M0,0 V528.915 H528.915 V0 H0 Z"
                              Data="F1 M528.915,528.915z M0,0z M232.327,5.055L232.327,46.757C232.327,51.827 228.254,56.472 223.26,57.347 111.818,76.916 26.851,174.347 26.851,291.309 26.851,422.326 133.44,528.914 264.456,528.914 395.474,528.914 502.062,422.325 502.062,291.309 502.062,278.634 491.787,268.359 479.112,268.359 466.437,268.359 456.162,278.634 456.162,291.309 456.162,397.016 370.164,483.015 264.456,483.015 158.748,483.015 72.75,397.016 72.75,291.309 72.75,199.726 137.319,122.981 223.314,104.101 228.265,103.015 232.326,106.46 232.326,111.528L232.326,148.251C232.326,153.321,235.509,154.83,239.434,151.623L324.055,82.461C327.981,79.251,327.981,74.052,324.055,70.842L239.436,1.686C235.51,-1.524,232.327,-0.012,232.327,5.055z"/>
                            <TextBox Text="{Binding TransitionTokensString, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" TextAlignment="Left"
                                         HorizontalAlignment="Center" FontWeight="Bold" Foreground="Black" Background="Transparent" Width="50"/>
                        </StackPanel>
                        
                        <Path Stroke="{StaticResource EdgeBrush}"
                            StrokeThickness="2" MinWidth="1" MinHeight="1"
                            ToolTip="{TemplateBinding ToolTip}" 
                            x:Name="PART_edgePath"/>
                        <controls:DefaultEdgePointer NeedRotation="true" x:Name="PART_EdgePointerForTarget" >
                            <Path Data="M0,0.5 L1,1 1,0" Fill="Black" Stretch="Uniform" Width="15" Height="15"/>
                        </controls:DefaultEdgePointer>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>

        <Setter Property="MinWidth" Value="1" />
        <Setter Property="MinHeight" Value="1" />
        <Setter Property="Background" Value="Red" />
        <Setter Property="Foreground" Value="Silver" />
        <Setter Property="Opacity" Value="1" />

        <Setter Property="controls:HighlightBehaviour.IsHighlightEnabled" Value="False"/>

        <Style.Triggers>
            <Trigger Property="controls:HighlightBehaviour.Highlighted" Value="True">
                <Setter Property="Foreground" Value="Gold"/>
                <Setter Property="StrokeThickness" Value="5"/>
            </Trigger>
            <Trigger Property="controls:HighlightBehaviour.Highlighted" Value="False">
                <Setter Property="Foreground" Value="Silver"/>
                <Setter Property="StrokeThickness" Value="2"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- EDGE LABEL -->
    <Style TargetType="controls:AttachableEdgeLabelControl">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="Black"/>

        <!-- Custom label template body -->
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:AttachableEdgeLabelControl}">
                    <Border Background="White" BorderThickness="3" BorderBrush="Black">
                        <StackPanel Orientation="Horizontal">
                            <Label Content="ε:"/>
                            <CheckBox IsChecked="{Binding AttachNode.Edge.IsEpsilon}"/>
                            <TextBox Text="{Binding AttachNode.Edge.TransitionTokensString, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" TextAlignment="Left"
                                         HorizontalAlignment="Center" FontWeight="Bold" Foreground="Black" Background="Transparent" Width="50"/>
                        </StackPanel>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>