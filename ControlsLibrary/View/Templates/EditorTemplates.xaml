<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="http://schemas.panthernet.ru/graphx/"
                    xmlns:po="http://schemas.microsoft.com/winfx/2006/xaml/presentation/options"
                    xmlns:language="clr-namespace:ControlsLibrary.Properties.Langs"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib">
    
    <SolidColorBrush x:Key="EdgeArrowBrush" Color="Black" po:Freeze="true" />

    <Style x:Key="TransitionsEditor" TargetType="ContentControl">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="ε:" Grid.Row="0" Grid.Column="0" Foreground="Black"/>
                        <CheckBox IsChecked="{Binding IsEpsilon}" Grid.Row="0" Grid.Column="1"/>
                        <ContentControl Grid.Row="0" Grid.Column="2">
                            <ContentControl.Style>
                                <Style TargetType="ContentControl">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                                <TextBox Text="{Binding TransitionTokensString, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Top" TextAlignment="Left"
                                                             HorizontalAlignment="Center" FontWeight="Bold" Foreground="Black" Background="White" Width="30"/>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsEpsilon}" Value="True">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate/>
                                                </Setter.Value>
                                            </Setter>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ContentControl.Style>
                        </ContentControl>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VERTEX CONTROL -->
    <Style TargetType="{x:Type controls:VertexControl}">
        <Setter Property="Background" Value="White"/>
        <Setter Property="BorderBrush" Value="Black"/>
        <Setter Property="VertexShape" Value="Circle"/>
        <Setter Property="ShowLabel" Value="True"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:VertexControl}">
                    <Grid Width="100" Height="100" >
                        <Button MaxHeight="20" Command="{Binding ChangeHidingCommand}" Background="Transparent" BorderThickness="0" HorizontalAlignment="Right" VerticalAlignment="Top">
                            <Path Data="F1 M330,330z M0,0z M325.607,304.394L262.128,240.915C300.698,211.88 325.65,175.995 327.375,173.478 330.876,168.368 330.876,161.632 327.375,156.522 324.45,152.253 254.716,51.978 165.004,51.978 139.132,51.978 114.929,60.323 93.5050000000001,72.291L25.607,4.394C19.75,-1.464 10.252,-1.464 4.394,4.394 -1.464,10.252 -1.464,19.749 4.394,25.607L67.872,89.085C29.299,118.12 4.35,154.006 2.625,156.523 -0.875,161.632 -0.875,168.368 2.625,173.478 5.55,177.746 75.275,278.024 165.003,278.024 190.871,278.024 215.072,269.679 236.496,257.71L304.393,325.608C307.323,328.536 311.161,330 315,330 318.839,330 322.678,328.536 325.606,325.606 331.465,319.749 331.465,310.252 325.607,304.394z M165.003,81.977C225.263,81.977 278.411,142.315 296.26,164.999 286.587,177.293 266.555,200.628 240.651,219.438L115.673,94.461C131.079,86.902,147.736,81.977,165.003,81.977z M165.003,248.023C104.718,248.023 51.564,187.659 33.73,164.986 43.381,152.683 63.382,129.328 89.304,110.516L214.294,235.506C198.884,243.084,182.236,248.023,165.003,248.023z"
                                              Fill="Black" Stretch="Uniform"/>
                        </Button>
                        <Ellipse x:Name="BackgroundNorm" Stroke="{TemplateBinding BorderBrush}" Fill="{TemplateBinding Background}" StrokeThickness="3" Width="100" Height="100"/>
                        <Ellipse Visibility="{Binding FinalMarkVisibility}" Stroke="{TemplateBinding BorderBrush}" Fill="{TemplateBinding Background}" StrokeThickness="2" Height="90" Width="90"/>
                        <StackPanel MaxWidth="78" MaxHeight="68" VerticalAlignment="Center" HorizontalAlignment="Center">
                            <StackPanel Orientation="Horizontal" Height="25">
                                <TextBlock Text="{x:Static language:Lang.stateName}" VerticalAlignment="Top"/>
                                <TextBox Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Top" TextAlignment="Left"
                                         HorizontalAlignment="Center" FontWeight="Bold" Foreground="Black" Background="Transparent" Width="30"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Height="25">
                                <TextBlock Text="{x:Static language:Lang.isAccept}" VerticalAlignment="Top"/>
                                <CheckBox IsChecked="{Binding IsFinal, Mode=TwoWay}" VerticalAlignment="Top"
                                         HorizontalAlignment="Center" FontWeight="Bold" Foreground="Black" Background="Transparent"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Height="25">
                                <TextBlock Text="{x:Static language:Lang.isInitial}" VerticalAlignment="Top"/>
                                <CheckBox IsChecked="{Binding IsInitial, Mode=TwoWay}" VerticalAlignment="Top"
                                         HorizontalAlignment="Center" FontWeight="Bold" Foreground="Black" Background="Transparent"/>
                            </StackPanel>
                        </StackPanel>
                        <controls:VertexLabelControl x:Name="PART_vertexLabel" LabelPositionSide="Left">
                            <Path Data="M0,0.5 L1,1 1,0" Fill="Black" Stretch="Uniform" Width="15" Height="15" Visibility="{Binding IsInitialMarkVisibility}">
                                <Path.LayoutTransform>
                                    <RotateTransform Angle="180"/>
                                </Path.LayoutTransform>
                            </Path>
                        </controls:VertexLabelControl>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>

        <!-- VERTEX DRAGGING CONTROL -->
        <Setter Property="controls:DragBehaviour.IsDragEnabled" Value="False" />
        <Setter Property="controls:DragBehaviour.UpdateEdgesOnMove" Value="True" />

        <Style.Triggers>
            <Trigger Property="controls:HighlightBehaviour.Highlighted" Value="True">
                <Setter Property="BorderBrush" Value="Gold"/>
                <Setter Property="BorderThickness" Value="3"/>
            </Trigger>
            <DataTrigger Binding="{Binding IsActual}" Value="True">
                <Setter Property="Background" Value="PaleVioletRed"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding IsExpanded}" Value="False">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type controls:VertexControl}">
                            <Grid Width="100" Height="100" >
                                <Button MaxHeight="20" Command="{Binding ChangeHidingCommand}" Background="Transparent" BorderThickness="0" HorizontalAlignment="Right" VerticalAlignment="Top">
                                    <Path Data="F1 M16,16z M0,0z M13.657,2.343A2,2,0,0,1,13.657,5.172L6.27,12.558A2.5,2.5,0,0,1,5.109,13.216L2.818,13.788A0.5,0.5,0,0,1,2.212,13.182L2.784,10.891A2.5,2.5,0,0,1,3.442,9.73L10.828,2.343A2,2,0,0,1,13.657,2.343z M10.12,4.464L4.15,10.437A1.5,1.5,0,0,0,3.756,11.134L3.385,12.616 4.867,12.246A1.5,1.5,0,0,0,5.564,11.851L11.536,5.878 10.122,4.464z M11.535,3.05L10.827,3.757 12.241,5.171 12.949,4.464A1,1,0,1,0,11.535,3.05z"
                                              Clip="M0,0 V16 H16 V0 H0 Z" Fill="Black" Stretch="Uniform"/>
                                </Button>
                                <Ellipse x:Name="BackgroundNorm" Stroke="{TemplateBinding BorderBrush}" Fill="{TemplateBinding Background}" StrokeThickness="3" Width="100" Height="100"/>
                                <Ellipse Visibility="{Binding FinalMarkVisibility}" Stroke="{TemplateBinding BorderBrush}" Fill="{TemplateBinding Background}" StrokeThickness="2" Height="90" Width="90"/>
                                <TextBlock Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" TextAlignment="Center"
                                         HorizontalAlignment="Center" FontWeight="Bold" Foreground="Black" Background="Transparent" FontSize="30"/>
                                <controls:VertexLabelControl x:Name="PART_vertexLabel" LabelPositionSide="Left" >
                                    <Path Data="M0,0.5 L1,1 1,0" Fill="Black" Stretch="Uniform" Width="15" Height="15" Visibility="{Binding IsInitialMarkVisibility}">
                                        <Path.LayoutTransform>
                                            <RotateTransform Angle="180"/>
                                        </Path.LayoutTransform>
                                    </Path>
                                </controls:VertexLabelControl>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <!-- EDGE CONTROL -->
    <Style TargetType="{x:Type controls:EdgeControl}">
        <Setter Property="SelfLoopIndicatorOffset" Value="80, 6"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:EdgeControl}">
                    <Grid>
                        <Grid x:Name="PART_SelfLoopedEdge">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="20"/>
                                <RowDefinition Height="50"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Image Stretch="Uniform" Height="70" Grid.RowSpan="2" Grid.ColumnSpan="3">
                                <Image.Source>
                                    <DrawingImage >
                                        <DrawingImage.Drawing>
                                            <DrawingGroup ClipGeometry="M0,0 V5.2916667 H5.2916667 V0 H0 Z">
                                                <DrawingGroup Opacity="1">
                                                    <DrawingGroup Opacity="1" Transform="1,0,0,1,-1.984375,-1.1103051">
                                                        <GeometryDrawing Geometry="F0 M5.2916667,5.2916667z M0,0z M3.8616831,5.9747834A1.1191912,2.2049735,0,0,1,4.1902343,3.0550256A1.1191912,2.2049735,0,0,1,5.6938085,3.4660738A1.1191912,2.2049735,0,0,1,5.6064274,6.451763">
                                                            <GeometryDrawing.Pen>
                                                                <Pen Brush="#FF000000" Thickness="0.132292" StartLineCap="Flat" EndLineCap="Flat" LineJoin="Miter" />
                                                            </GeometryDrawing.Pen>
                                                        </GeometryDrawing>
                                                        <DrawingGroup Transform="0.58287604,0.12660212,-0.14552687,0.50707709,3.1732333,3.8465829">
                                                            <GeometryDrawing Brush="#FF030000" Geometry="F1 M5.2916667,5.2916667z M0,0z M1.0651849,3.2972248L2.5603007,2.9222117 2.1375137,4.4045266z" />
                                                        </DrawingGroup>
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingGroup>
                                        </DrawingImage.Drawing>
                                    </DrawingImage>
                                </Image.Source>
                            </Image>
                            <ContentControl Grid.Row="0" Style="{StaticResource TransitionsEditor}"/>
                        </Grid>
                        <Path Stroke="Black"
                            StrokeThickness="2" MinWidth="1" MinHeight="1"
                            ToolTip="{TemplateBinding ToolTip}" 
                            x:Name="PART_edgePath"/>
                        <controls:DefaultEdgePointer NeedRotation="true" x:Name="PART_EdgePointerForTarget" >
                            <Path Data="M0,0.5 L1,1 1,0" Fill="Black" Stretch="Uniform" Width="15" Height="15"/>
                        </controls:DefaultEdgePointer>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>

        <Setter Property="MinWidth" Value="1" />
        <Setter Property="MinHeight" Value="1" />
        <Setter Property="Background" Value="Red" />
        <Setter Property="Foreground" Value="Silver" />
        <Setter Property="Opacity" Value="1" />

        <Setter Property="controls:HighlightBehaviour.IsHighlightEnabled" Value="False"/>

        <Style.Triggers>
            <Trigger Property="controls:HighlightBehaviour.Highlighted" Value="True">
                <Setter Property="Foreground" Value="Gold"/>
                <Setter Property="StrokeThickness" Value="5"/>
            </Trigger>
            <Trigger Property="controls:HighlightBehaviour.Highlighted" Value="False">
                <Setter Property="Foreground" Value="Silver"/>
                <Setter Property="StrokeThickness" Value="2"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- EDGE LABEL -->
    <Style TargetType="controls:AttachableEdgeLabelControl" >
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="Black"/>

        <!-- Custom label template body -->
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <ContentControl Style="{StaticResource TransitionsEditor}" DataContext="{Binding AttachNode.Edge}"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>